{% extends "base.html" %}

{% block content %}

<!-- MathLive para que las celdas de la matriz sean “bonitas” -->
<script defer src="https://cdn.jsdelivr.net/npm/mathlive"></script>

<style>
  /* Ocultar botones del teclado virtual de MathLive */
  math-field::part(virtual-keyboard-toggle),
  math-field::part(menu-toggle) {
    display: none !important;
  }

  /* Estilo de los math-field dentro de las celdas de la matriz */
  .matrix-table td math-field {
    display: block;
    width: 100%;
    height: 100%;
    padding: 0.25rem 0.5rem;
    box-sizing: border-box;
    border-radius: 0.75rem;
    border: none;
    background: transparent;
    color: inherit;
  }

  .matrix-table td math-field::part(content) {
    color: inherit;
  }
</style>

<div class="space-y-8">
  <section class="panel">
    <h2 class="panel-title text-slate-900">Traspuesta de una Matriz</h2>
    <div class="grid grid-cols-1 sm:grid-cols-4 gap-4 items-end">
      <label class="block">
        <span class="lbl">Filas (m)</span>
        <input id="inp-filas" type="number" min="1" value="2" class="input" />
      </label>
      <label class="block">
        <span class="lbl">Columnas (n)</span>
        <input id="inp-columnas" type="number" min="1" value="3" class="input" />
      </label>
      <div class="sm:col-span-2">
        <button id="btn-crear" class="btn-primary w-full">Crear Matriz</button>
      </div>
    </div>
  </section>

  <section id="zona-matriz" class="panel hidden">
    <h3 class="text-lg font-semibold text-slate-900 mb-3">Matriz A (m×n)</h3>
    <div class="min-w-full overflow-auto rounded-xl border border-slate-200">
      <table id="tabla-A" class="matrix-table w-full"></table>
    </div>

    <!-- TECLADO BLANCO TIPO "GAUSS" -->
    <div class="keypad mt-3">
      <button class="key" data-ins="(">(</button>
      <button class="key" data-ins=")">)</button>
      <button class="key" data-ins="+">+</button>
      <button class="key" data-ins="-">−</button>
      <button class="key" data-ins="*">×</button>
      <button class="key" data-ins="/">÷</button>
      <button class="key" data-ins="x^">x²</button>
      <button class="key" data-ins="sqrt()">√</button>
      <button class="key" data-ins="sin()">sin</button>
      <button class="key" data-ins="cos()">cos</button>
      <button class="key" data-ins="tan()">tan</button>
      <button class="key" data-ins="pi">π</button>
      <button class="key" data-ins="e">e</button>
    </div>

    <div class="mt-4 flex gap-3">
      <button id="btn-resolver" class="btn-accent">Calcular Traspuesta</button>
      <span id="msg" class="text-sm text-slate-500"></span>
    </div>
  </section>

  <section id="zona-resultado" class="panel hidden">
    <h3 class="text-lg font-semibold text-slate-900 mb-3">Resultado: Aᵗ</h3>
    <div class="overflow-auto max-h-[50vh] rounded-xl border border-slate-200">
      <table id="tabla-resultado" class="matrix-table w-full"></table>
    </div>
  </section>
</div>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/traspuesta.js') }}" defer></script>
{% endblock %}
